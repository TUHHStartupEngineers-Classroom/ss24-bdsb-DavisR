{
  "hash": "075bb0559b93aa9202cb428401a625cd",
  "result": {
    "markdown": "---\ntitle: \"Data Wrangling\"\nauthor: \"Davis Rakhshan\"\n---\n\n\n# Challenge on alternative / reduced data\n\n## Question 1\n\nPatent Dominance: What US company / corporation has the most patents? List the 10 US companies with the most assigned/granted patents.\n\nAnswer:\n\nFor this we use the reduced data set due to computational restrictions. The data sets will be read in and wrangled and filtered according to US-company specific keywords. Then the companies with the most patents will be printed.\n\nCode:\n\n\n::: {.cell hash='03_data_wrangling_cache/html/unnamed-chunk-1_8d96e333a35d852e217cfada336f19df'}\n\n```{.r .cell-code}\nlibrary(data.table)\nlibrary(dplyr)\nlibrary(vroom)\nlibrary(magrittr) \n\n\n# Challenge\ncol_types <- list(\n  id = col_character(),\n  type = col_character(),\n  number = col_character(),\n  country = col_character(),\n  date = col_date(\"%Y-%m-%d\"),\n  abstract = col_character(),\n  title = col_character(),\n  kind = col_character(),\n  num_claims = col_double(),\n  filename = col_character(),\n  withdrawn = col_double()\n)\n\npatent_tbl <- vroom(\n  file       = \"../../scripts/Patent_data_reduced/patent.tsv\", \n  delim      = \"\\t\", \n  col_types  = col_types,\n  na         = c(\"\", \"NA\", \"NULL\")\n)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n#> Warning: The following named parsers don't match the column names: type,\n#> number, country, abstract, title, kind, filename, withdrawn\n```\n:::\n\n```{.r .cell-code}\npatent_assignee_tbl <- vroom(\n  file       = \"../../scripts/Patent_data_reduced/patent_assignee.tsv\", \n  delim      = \"\\t\", \n  col_types  = col_types,\n  na         = c(\"\", \"NA\", \"NULL\")\n)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n#> Warning: The following named parsers don't match the column names: id, type,\n#> number, country, date, abstract, title, kind, num_claims, filename, withdrawn\n```\n:::\n\n```{.r .cell-code}\nassignee_tbl <- vroom(\n  file       = \"../../scripts/Patent_data_reduced/assignee.tsv\", \n  delim      = \"\\t\", \n  col_types  = col_types,\n  na         = c(\"\", \"NA\", \"NULL\")\n)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n#> Warning: The following named parsers don't match the column names: number,\n#> country, date, abstract, title, kind, num_claims, filename, withdrawn\n```\n:::\n\n```{.r .cell-code}\nuspc_tbl <- vroom(\n  file       = \"../../scripts/Patent_data_reduced/uspc.tsv\", \n  delim      = \"\\t\", \n  col_types  = col_types,\n  na         = c(\"\", \"NA\", \"NULL\")\n)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n#> Warning: The following named parsers don't match the column names: id, type,\n#> number, country, date, abstract, title, kind, num_claims, filename, withdrawn\n```\n:::\n\n```{.r .cell-code}\n# Question 1\n# For 1\tassignee, patent_assignee\n# Merge tables and count patents per organization\nmerged_tbl <- merge(assignee_tbl, patent_assignee_tbl, by.x = \"id\", by.y = \"assignee_id\", all.x = TRUE)\n\n# Filter US companies and count patents\n# US companies are being filtered by US specific keywords\npatent_counts <- merged_tbl %>%\n  filter(grepl(\"Inc\\\\.|LLC|Corporation|Corporated|Company|Ltd\\\\.|Incorporated\", organization, ignore.case = TRUE)) %>%\n  group_by(organization) %>%\n  summarise(patent_count = n()) %>%\n  arrange(desc(patent_count))\n\n# Print the result\nprint(patent_counts)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#> # A tibble: 28,689 × 2\n#>    organization                                patent_count\n#>    <chr>                                              <int>\n#>  1 International Business Machines Corporation         7547\n#>  2 Samsung Electronics Co., Ltd.                       5835\n#>  3 Sony Corporation                                    3326\n#>  4 Microsoft Corporation                               3165\n#>  5 Google Inc.                                         2668\n#>  6 QUALCOMM Incorporated                               2597\n#>  7 LG Electronics Inc.                                 2459\n#>  8 Panasonic Corporation                               2218\n#>  9 Apple Inc.                                          2201\n#> 10 General Electric Company                            1873\n#> # ℹ 28,679 more rows\n```\n:::\n:::\n\n\n## Question 2\n\nQuestion:\n\nRecent patent activity: What US company had the most patents granted in August 2014? List the top 10 companies with the most new granted patents for August 2014.\n\nAnswer:\n\nFor this I filtered the patents for August 2014 and US only. Then I summarized the number of their patents to get the companies that had the most patents. These are printed out.\n\nCode:\n\n\n::: {.cell hash='03_data_wrangling_cache/html/unnamed-chunk-2_b628df1ab2e5b0fd073f4cb7567d699e'}\n\n```{.r .cell-code}\n# For 2\tassignee, patent_assignee, patent\n# Filter patents granted in August 2014\naugust_patents <- patent_tbl %>%\n  filter(format(date, \"%Y-%m\") == \"2014-08\")\n\n# Join with patent_assignee_tbl to get assignee information\npatents_assignees <- august_patents %>%\n  inner_join(patent_assignee_tbl, by = c(\"id\" = \"patent_id\"))\n\n# Join with assignee_tbl to get assignee information\npatents_assignees_details <- patents_assignees %>%\n  inner_join(assignee_tbl, by = c(\"assignee_id\" = \"id\"))\n\n# Filter only US companies\nus_companies <- patents_assignees_details %>%\n  filter(grepl(\"USA\", organization, ignore.case = TRUE))\n\n# Count patents granted to each US company\npatents_count <- us_companies %>%\n  group_by(organization) %>%\n  summarise(num_patents = n()) %>%\n  arrange(desc(num_patents))\n\n# Select top 10 companies\ntop_10_us_companies <- head(patents_count, 10)\n\nprint(top_10_us_companies)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#> # A tibble: 10 × 2\n#>    organization                                                      num_patents\n#>    <chr>                                                                   <int>\n#>  1 Siemens Medical Solutions USA, Inc.                                        12\n#>  2 ECOLAB USA INC.                                                             9\n#>  3 HITACHI KOKUSAI ELECTRIC INC.                                               8\n#>  4 United Services Automobile Association (USAA)                               6\n#>  5 Ecole Polytechnique Federale de Lausanne (EPFL)                             3\n#>  6 Philip Morris USA Inc.                                                      3\n#>  7 Yissum Research Development Company of the Hebrew University of …           3\n#>  8 CAUSAM ENERGY, INC.                                                         2\n#>  9 Hendrickson USA, L.L.C.                                                     2\n#> 10 Musashi Engineering, Inc.                                                   2\n```\n:::\n:::\n\n\n## Question 3\n\nQuestion:\n\nInnovation in Tech: What is the most innovative tech sector? For the top 10 companies (worldwide) with the most patents, what are the top 5 USPTO tech main classes?\n\nAnswer:\n\nFor this the the companies with the most number of patents will be taken and then for those the top company classes will be taken to be printed out, which are the top 5 tech classes of the top 10 companies.\n\nCode:\n\n\n::: {.cell hash='03_data_wrangling_cache/html/unnamed-chunk-3_cf35a0bcb5135877156c14696b1fdd3a'}\n\n```{.r .cell-code}\n# Question 3\n# For 3\tassignee_tbl, patent_assignee_tbl, uspc_tbl\n# Find top 10 companies with most patents\ntop_10_companies <- patent_assignee_tbl %>%\n  group_by(assignee_id) %>%\n  summarise(num_patents = n()) %>%\n  arrange(desc(num_patents)) %>%\n  top_n(10)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n#> Selecting by num_patents\n```\n:::\n\n```{.r .cell-code}\n# Join with assignee_tbl to get org information\ntop_10_companies_with_org <- top_10_companies %>%\n  inner_join(select(assignee_tbl, -type), by = c(\"assignee_id\" = \"id\"))\n\n\n# Main classes of patents\ntop_10_main_classes <- top_10_companies_with_org %>%\n  inner_join(patent_assignee_tbl, by = \"assignee_id\") %>%\n  inner_join(uspc_tbl %>% mutate(patent_id = as.character(patent_id)), by = \"patent_id\") %>%\n  group_by(mainclass_id) %>%\n  summarise(num_patents = n()) %>%\n  arrange(desc(num_patents)) %>%\n  top_n(5)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n#> Warning in inner_join(., uspc_tbl %>% mutate(patent_id = as.character(patent_id)), : Detected an unexpected many-to-many relationship between `x` and `y`.\n#> ℹ Row 1 of `x` matches multiple rows in `y`.\n#> ℹ Row 373502 of `y` matches multiple rows in `x`.\n#> ℹ If a many-to-many relationship is expected, set `relationship =\n#>   \"many-to-many\"` to silence this warning.\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n#> Selecting by num_patents\n```\n:::\n\n```{.r .cell-code}\nprint(top_10_main_classes)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#> # A tibble: 5 × 2\n#>   mainclass_id num_patents\n#>          <dbl>       <int>\n#> 1          257        7956\n#> 2          455        6120\n#> 3          370        5448\n#> 4          348        4102\n#> 5          709        4010\n```\n:::\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"../../site_libs/pagedtable-1.1/css/pagedtable.css\" rel=\"stylesheet\" />\r\n<script src=\"../../site_libs/pagedtable-1.1/js/pagedtable.js\"></script>\r\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}